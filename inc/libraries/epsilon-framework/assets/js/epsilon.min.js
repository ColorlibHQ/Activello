var EpsilonFramework="undefined"==typeof EpsilonFramework?{}:EpsilonFramework;EpsilonFramework.colorSchemes=function(){function a(){_.each(g,function(a){h.data[a]=e(a)()}),e.previewer.send("update-inline-css",h)}var b,c,d,e,f=jQuery(".epsilon-color-scheme"),g=[],h={};f.length&&(b=f.find(".epsilon-color-scheme-option"),c=f.parent().find(".epsilon-color-scheme-input"),d=jQuery.parseJSON(b.first().find("input").val()),e=wp.customize,g=[],h={action:"epsilon_generate_color_scheme_css","class":"Epsilon_Color_Scheme",id:"",data:{}},jQuery.each(d,function(a,b){g.push(a)}),_.each(g,function(b){e(b,function(b){b.bind(a)})}),jQuery(".epsilon-color-scheme-option").on("click",function(){var b=jQuery(this).attr("data-color-id"),d=jQuery.parseJSON(jQuery(this).find("input").val());jQuery.each(d,function(a,b){g.push(a),wp.customize(a).set(b)}),jQuery(this).siblings(".epsilon-color-scheme-option").removeClass("selected"),jQuery(this).addClass("selected"),c.val(b).change(),_.each(g,function(b){e(b,function(b){b.bind(a())})})}))},EpsilonFramework.rangeSliders=function(a){var b=jQuery(a),c=b.find(".slider-container");jQuery.each(c,function(){var a=jQuery(this).find(".ss-slider"),b=jQuery(this).find(".rl-slider"),c=b.attr("id"),d=a.attr("id"),e=jQuery("#"+d).attr("data-attr-min"),f=jQuery("#"+d).attr("data-attr-max"),g=jQuery("#"+d).attr("data-attr-step");jQuery("#"+d).slider({value:jQuery("#"+c).attr("value"),range:"min",min:parseFloat(e),max:parseFloat(f),step:parseFloat(g),slide:function(a,b){jQuery("#"+c).attr("value",b.value)},stop:function(a,b){jQuery("#"+c).trigger("change")}}),jQuery(b).on("focus",function(){jQuery(this).blur()}),jQuery("#"+c).attr("value",jQuery("#"+d).slider("value")),jQuery("#"+c).on("change",function(){jQuery("#"+d).slider({value:jQuery(this).val()})})})},EpsilonFramework.recommendedActions={_init:function(){var a=jQuery(".control-section-epsilon-section-recommended-actions"),b=a.find(".epsilon-recommended-plugin-button"),c=a.find(".epsilon-dismiss-required-action");this.dismissActions(c),this.dismissPlugins(b)},dismissActions:function(a){a.on("click",function(){var a,b,c,d=jQuery(this),e=d.parents(".epsilon-recommended-actions-container"),f=parseInt(e.attr("data-index")),g=e.parents(".control-section-epsilon-section-recommended-actions").find("h3"),h=g.find(".epsilon-actions-count > .current-index"),i=parseInt(h.attr("data-total")),j=e.next(),k={action:["Epsilon_Framework","dismiss_required_action"],args:{id:jQuery(this).attr("id"),option:jQuery(this).attr("data-option")}};jQuery.ajax({type:"POST",data:{action:"epsilon_framework_ajax_action",args:k},dataType:"json",url:WPUrls.ajaxurl,success:function(d){d.status&&"ok"===d.message&&(f>=i?(a=g.find(".section-title"),b=jQuery(".epsilon-recommended-plugins"),c=a.attr("data-social"),b.length&&(c=a.attr("data-plugin_text")),g.find(".epsilon-actions-count").remove(),a.text(c)):h.text(f+1),e.fadeOut("200",function(){j.css({opacity:1,height:"initial"}).fadeIn("200")}))},error:function(a,b,c){console.log(a+" :: "+b+" :: "+c)}})})},dismissPlugins:function(a){a.on("click",function(){var a,b,c=jQuery(this),d=c.parents(".epsilon-recommended-plugins"),e=d.next(),f=d.parents(".control-section-epsilon-section-recommended-actions").find("h3"),g={action:["Epsilon_Framework","dismiss_required_action"],args:{id:jQuery(this).attr("id"),option:jQuery(this).attr("data-option")}};jQuery.ajax({type:"POST",data:{action:"epsilon_framework_ajax_action",args:g},dataType:"json",url:WPUrls.ajaxurl,success:function(c){c.status&&"ok"===c.message&&d.fadeOut("200",function(){e.is("p")&&(a=f.find(".section-title"),b=a.attr("data-social"),a.text(b)),e.css({opacity:1,height:"initial"}).fadeIn("200")})},error:function(a,b,c){console.log(a+" :: "+b+" :: "+c)}})})}},EpsilonFramework.typography={_selectize:null,_linkedFonts:{},_init:function(){var a=jQuery(".epsilon-typography-container"),b=this;a.length&&(jQuery.each(a,function(){var a=jQuery(this),c=a.attr("data-unique-id"),d=a.find("select"),e=a.find(".epsilon-typography-input");try{b._selectize=d.selectize()}catch(f){console.warn("selectize not yet loaded")}e.on("change",function(){var a=EpsilonFramework.typography._parseJson(e,c);jQuery("#hidden_input_"+c).val(a).trigger("change")})}),EpsilonFramework.rangeSliders(".epsilon-typography-container"),jQuery(".epsilon-typography-default").on("click",function(a){a.preventDefault(),EpsilonFramework.typography._resetDefault(jQuery(this))}),jQuery(".epsilon-typography-advanced-options-toggler").on("click",function(a){var b=jQuery(this).attr("data-toggle");a.preventDefault(),jQuery(this).toggleClass("active").parent().toggleClass("active"),jQuery("#"+b).slideToggle().addClass("active")}))},_resetDefault:function(a){var b,c=jQuery(a).parent(),d=c.attr("data-unique-id"),e=c.find("select"),f=(c.find("inputs"),e[0].selectize),g={action:"epsilon_generate_typography_css","class":"Epsilon_Typography",id:d,data:{selectors:jQuery("#selectors_"+d).val(),json:{}}},h=wp.customize;f.setValue("default_font"),jQuery("#"+d+"-font-size").length&&(b=jQuery("#"+d+"-font-size").attr("data-default-font-size"),jQuery("#"+d+"-font-size").val(b).trigger("change").trigger("blur"),g.data.json["font-size"]=""),jQuery("#"+d+"-line-height").length&&(b=jQuery("#"+d+"-line-height").attr("data-default-line-height"),jQuery("#"+d+"-line-height").val(b).trigger("change").trigger("blur"),g.data.json["line-height"]=""),jQuery("#"+d+"-letter-spacing").length&&(b=jQuery("#"+d+"-letter-spacing").attr("data-default-letter-spacing"),jQuery("#"+d+"-letter-spacing").val(b).trigger("change").trigger("blur"),g.data.json["letter-spacing"]=""),g.data.json["font-family"]="default_font",g.data.json["font-weight"]="",g.data.json["font-style"]="",h.previewer.send("update-inline-css",g)},_parseJson:function(a,b){var c={action:"epsilon_generate_typography_css","class":"Epsilon_Typography",id:b,data:{selectors:jQuery("#selectors_"+b).val(),json:{}}},d=wp.customize;return jQuery.each(a,function(a,d){var e=jQuery(d).attr("id"),f=b+"-",g=jQuery(this).attr("type");e=e.replace(f,""),"checkbox"===g?c.data.json[e]=jQuery(this).prop("checked")?jQuery(d).val():"":c.data.json[e]=jQuery(d).val()}),d.previewer.send("update-inline-css",c),JSON.stringify(c.data)}},jQuery(document).on("widget-updated widget-added",function(a,b){jQuery().slider&&EpsilonFramework.rangeSliders(b)}),"undefined"!=typeof wp&&"undefined"!=typeof wp.customize&&(wp.customize.bind("ready",function(){EpsilonFramework.typography._init(),EpsilonFramework.colorSchemes(),EpsilonFramework.recommendedActions._init()}),wp.customize.sectionConstructor["epsilon-section-pro"]=wp.customize.Section.extend({attachEvents:function(){},isContextuallyActive:function(){return!0}}),wp.customize.sectionConstructor["epsilon-section-recommended-actions"]=wp.customize.Section.extend({attachEvents:function(){},isContextuallyActive:function(){return!0}}));